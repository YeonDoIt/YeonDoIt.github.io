---
title: "캐시 메모리"
author: yeon
date: 2024-10-21 22:30:00 +0900
categories: [DEV, 컴퓨터구조]
tags: [저장 장치 계층 구조, 캐시 메모리, 참조 지역성의 원리, 공간 지역성, 캐시 히트, 캐시 미스, 캐시 적중률]
---

![alt text](/assets/img/컴퓨터구조/캐시메모리/image.png)
- CPU가 메모리에 접근하는 시간은 CPU 연산 속도보다 느리다.

## 저장 장치 계층 구조

- CPU와 가까운 저장 장치는 빠르고, 멀리 있는 저장 장치는 느리다.
- 속도가 빠른 저장 장치는 저장 용량이 작고, 가격이 비싸다.

### 레지스터 vs 메모리(RAM) vs USB 메모리

![alt text](/assets/img/컴퓨터구조/캐시메모리/image-1.png)

- 즉, 낮은 가격대의 대용량 저장 장치를 원한다면 느린 속도는 감수해야 하고, 빠른 속도의 저장 장치를 원한다면 작은 용량과 비싼 가격은 감수해야 한다.
- 저장 장치들은 'CPU에 얼마나 가까운가'를 기준으로 계층적으로 나타낼 수 있다.

> 저장 장치 계층 구조를 영문으로 나타내면 memory hierarchy, 메모리 계층 구조를 의미한다. 여기서 '메모리'라는 용어는 RAM이 아닌 일반적인 저장 장치를 의미한다.

## 캐시 메모리

- CPU와 메모리 사이에 위치한, 레지스터보다 용량이 크고 메모리보다 빠른 SRAM 기반의 저장 장치
- CPU의 연산 속도와 메모리 접근 속도의 차이를 조금이나마 줄이기 위해 탄생함
- "CPU가 매번 메모리에 왔다갔다 하는 건 시간이 오래 걸리기 때문에 메모리에서 CPU가 사용할 일부 데이터를 미리 캐시 메모리로 가지고 와서 사용하자"

![alt text](/assets/img/컴퓨터구조/캐시메모리/image-2.png)
- 메모리에 접근 = 물건을 사러 가는 것
- 메모리 = 물건은 많지만 집과는 멀리 떨어져 있어 왕복이 오래 걸리는 대형 마트
- 캐시 메모리 = 물건이 많지는 않아도 집과 가까이 있는 편의점

![alt text](/assets/img/컴퓨터구조/캐시메모리/image-3.png)

### 캐시 메모리까지 반영한 저장 장치 계층 구조

![alt text](/assets/img/컴퓨터구조/캐시메모리/image-4.png)

### 계층적 캐시 메모리 (L1 - L2 - L3 캐시)

![alt text](/assets/img/컴퓨터구조/캐시메모리/image-5.png)

> 일반적으로 L1 캐시와 L2 캐시는 코어 내부에, L3 캐시는 코어 외부에 위치해있다.

### 멀티코어 프로세서의 캐시 메모리

![alt text](/assets/img/컴퓨터구조/캐시메모리/image-6.png)

### 분리형 캐시

![alt text](/assets/img/컴퓨터구조/캐시메모리/image-7.png)

- L1 캐시를 명령어만(L1I), 데이터만(L1D) 저장할 수 있도록 분리함

### 계층적 캐시 메모리까지 반영한 저장 장치 계층 구조

![alt text](/assets/img/컴퓨터구조/캐시메모리/image-8.png)

## 참조 지역성의 원리

> Q : 캐시 메모리는 메모리보다 용량이 작다. 당연하게 메모리의 모든 내용을 저장할 수 없다. 그렇다면 무엇을 저장할까?   
A : CPU가 자주 사용할만한 내용을 예측하여 저장

- 예측이 들어맞을 경우 (CPU가 캐시 메모리에 저장된 값을 활용할 경우) = 캐시 히트
![alt text](/assets/img/컴퓨터구조/캐시메모리/image-9.png)

- 예측이 틀렸을 경우 (CPU가 메모리에 접근해야 하는 경우) = 캐시 미스
![alt text](/assets/img/컴퓨터구조/캐시메모리/image-10.png)

- 캐시 적중률 = 캐시 히트 횟수 / (캐시 히트 횟수 + 캐시 미스 횟수)
- 즉, 캐시 적중률을 높여야 한다! (= CPU가 사용할만한 데이터를 잘 예측해야 한다!)

### 참조 지역성의 원리

- CPU가 메모리에 접근할 때의 주된 경향을 바탕으로 만들어진 원리
    - CPU는 최근에 접근했던 메모리 공간에 다시 접근하려는 경향이 있다.
        - ex. num이라는 변수가 여러번 참조되고 있음
        ![alt text](/assets/img/컴퓨터구조/캐시메모리/image-11.png)
    - CPU는 접근한 메모리 공간 근처를 접근하려는 경향이 있다. (= 공간 지역성)
        - ex. 메모리 내부에 프로그램은 프로그램끼리 저장되어 있음
        ![alt text](/assets/img/컴퓨터구조/캐시메모리/image-12.png)